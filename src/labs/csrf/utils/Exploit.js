import { parse } from "node-html-parser";

export { Exploit };

class Exploit {
  #parsedHtml;
  #form;

  constructor(rawHtml) {
    this.#parsedHtml = parse(rawHtml);
    this.#form = this.#parsedHtml.querySelector("form");
  }

  setFormAction(action) {
    const form = this.#parsedHtml.querySelector("form");
    form.setAttribute("action", action);
  }

  setCsrfToken(token) {
    const csrfInput = this.#form.querySelector("input[name='csrf']");
    csrfInput.setAttribute("value", token);
  }

  toString() {
    return this.#parsedHtml.toString();
  }
}
